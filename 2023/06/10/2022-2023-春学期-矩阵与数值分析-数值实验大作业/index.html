<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">2022-2023 春学期 矩阵与数值分析 数值实验大作业 | owuiviuwo&#39;s blog!</title>
  
    <link rel="shortcut icon" href="/images/hamster.png">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  
  <link rel="stylesheet" type="text/css" href="/css/matery.css">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "owuiviuwo";
  mashiro_option.author_name = "owuiviuwo";
  mashiro_option.site_url = "https://owuiviuwo.github.io/";
  mashiro_option.v_appId = "Bca3aRLRAJx2I6PNPDTapKBT-MdYXbMMI";
  mashiro_option.v_appKey = "o1JOvsCvLL7SkH0kH1SeRXKK";
  mashiro_option.mathjax = "1";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover0.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover1.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover2.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover3.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover4.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover5.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover6.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover7.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover8.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover9.webp,https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/cover/cover10.webp".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>

<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-grid">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <!--<a href="https://owuiviuwo.github.io/">-->
		<a href="/random.html">
          <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/avatar.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>Learn and Live</p>
        <div class="top-social_v2">
		<!-- 这里去掉了框架原来的显示前一张背景图功能 在themes\Sakura\layout\_partial\headertop.ejs下 -->
		<!--
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
		  -->
          
            
              
                <li>
                  <a href="http://github.com/owuiviuwo" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/social/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://www.cnblogs.com/owuiviuwo" target="_blank" class="social-github" title="cnblogs">
                    <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/social/cnblogs.svg">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://www.zhihu.com/people/owuiviuwo" target="_blank" class="social-github" title="zhihu">
                    <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/social/zhihu.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="mailto:owuiviuwo@163.com" target="_blank" class="social-github" title="email">
                    <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/social/email.svg">
                  </a>
                </li>
              
            
          
		  <!-- 这里去掉了框架原来的显示后一张背景图功能 在themes\Sakura\layout\_partial\headertop.ejs下 -->
		  <!--
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
		  -->
        </div>
      </div>
    </div>
  </figure>
  <!-- 这里去掉了框架原来的视频播放部分 在themes\Sakura\layout\_partial\headertop.ejs下 -->
  <!--
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  -->
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono"></span>
            <span class="shironeko">owuiviuwo</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/生活/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          生活
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/资源/">
                          <i class="fa fa-cloud-download" aria-hidden="true"></i>
                          资源
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/随想/">
                          <i class="fa fa-commenting-o" aria-hidden="true"></i>
                          随想
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/转载/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          转载
                        </a>
                      </li>
                    
                      <li>
                        <a href="/random.html">
                          <i class="fa fa-random" aria-hidden="true"></i>
                          随机
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    数据
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/statistics/">
                          <i class="fa fa-line-chart" aria-hidden="true"></i>
                          统计
                        </a>
                      </li>
                    
                      <li>
                        <a href="/postcategory/">
                          <i class="fa fa-list-ul faa-vertical" aria-hidden="true"></i>
                          分类
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/">
                          <i class="fa fa-tags" aria-hidden="true"></i>
                          标签
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/shuoshuo/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-clock-o" aria-hidden="true"></i>
                    说说
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/links/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
                    友人帐
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/donate/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
                    赞赏
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    其他
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                      <li>
                        <a href="/theme-sakura/">
                          <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                          主题
                        </a>
                      </li>
                    
                      <li>
                        <a href="/lab/">
                          <i class="fa fa-cogs" aria-hidden="true"></i>
                          Lab
                        </a>
                      </li>
                    
                      <li>
                        <a href="/atom.xml">
                          <i class="fa fa-rss faa-pulse" aria-hidden="true"></i>
                          RSS
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

  <div class="pattern-center single-center">
    <!-- 有配图默认渲染第一张 -->
    <div class="pattern-attachment-img lazyload" style="background-image: url(https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/03/10/6f1078d467166b315085abd04baa58bb-20230310134509511-d8f3a7.png);" src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/03/10/6f1078d467166b315085abd04baa58bb-20230310134509511-d8f3a7.png">
    </div>
    <header class="pattern-header single-header">
      <h1 class="entry-title">
      2022-2023 春学期 矩阵与数值分析 数值实验大作业</h1>
      <p class="entry-census">
        <span>
          <a href="https://owuiviuwo.github.io/">
            <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/avatar.jpg">
          </a>
        </span>
        <span>
          <a href="https://owuiviuwo.github.io/">owuiviuwo</a>
        </span>
        <span class="bull">
        ·</span>
        2023-6-10<span class="bull">
        ·</span>
      <span id="busuanzi_value_page_pv"></span>次阅读</p>
    </header>
  </div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">

       <div id="outDateInfo">
	   <!-- 过时信息提示，来源于 https://cndrew.cn/2020/04/04/date/ -->
	   <style>
		   .tip.share {
				border-left-color: rgb(238, 5, 5);
				background: #fff;
			}
			.tip {
				display:block;
				background: #fff;
				padding: 8px 20px;
				position: relative;
				margin: 0 0 20px;
			 
				font-family: Georgia, serif;
				font-size: 16px;
				line-height: 1.2;
				color: #666;
				text-align: justify;
				border-left: 5px solid      #3CB371;
			 
				/*盒子阴影 - (选项)*/
				-moz-box-shadow: 2px 2px 15px #ccc;
				-webkit-box-shadow: 2px 2px 15px #ccc;
				box-shadow: 2px 2px 15px #ccc;
			}
			.tip.share:before {
				background: #ddd;
				content: "🐷";
			}
			.tip:before {
				background: #38a3fd;
				border-radius: 50%;
				color: #fff;
				content: "i";
				font-family: Dosis,"Source Sans Pro","Helvetica Neue",Arial,sans-serif;
				font-size: 16px;
				height: 21px;
				line-height: 21px;
				margin-left: -32px;
				margin-top: 8px;
				position: absolute;
				text-align: center;
				width: 21px;
			}
	   </style>
	   	  <div id="point"></div>
			 <script>
			  function intervalTime(startTime,endTime){
				  var date1 = new Date(startTime);
				  var date2 = new Date(endTime);  
				  var date3 = date2.getTime() - date1.getTime(); 
				  var days = Math.floor(date3 / (24 * 3600 * 1000));
				  return days;
			  }
			  function format(Date){
				var Y = Date.getFullYear();
				var M = Date.getMonth() + 1;
				  M = M < 10 ? '0' + M : M;
				var D = Date.getDate();
				  D = D < 10 ? '0' + D : D;
				var H = Date.getHours();
				  H = H < 10 ? '0' + H : H;
				var Mi = Date.getMinutes();
				  Mi = Mi < 10 ? '0' + Mi : Mi;
				var S = Date.getSeconds();
				  S = S < 10 ? '0' + S : S;
				  return Y + '-' + M + '-' + D + ' ' + H + ':' + Mi + ':' + S;
			  }
			  // var pdate = new Date("1686402476000");
			  var pdate = new Date(1686402476000);
			  console.log("pdate="+pdate);
			  console.log("1686402476000");
			  //var update = new Date("1686402823759");
			  var update = new Date(1686402823759);
			  console.log("1686402823759");
			  console.log("update="+update);
			  var now = new Date();
			  console.log("now="+now);
			  now=format(now);
			  pdate=format(pdate);
			  update=format(update);
			  var days=intervalTime(pdate,now),udays=intervalTime(update,now);
			  var mid=parseInt(days,10);
			  var mi=parseInt("30",10);
			  if(mid > mi){
				document.getElementById("point").innerHTML="<div class=\"tip share\">请注意，本文编写于"+days+"天前，最后修改于"+udays+"天前，其中某些信息可能已经过时。<img src=\"https://cdn.jsdelivr.net/gh/drew233/cdn/kawayi.webp\"><\img> </div>";
			  }
			</script>
	   </div>

	  
	  <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <h1 id="2022-2023-春学期-矩阵与数值分析-数值实验大作业"><a href="#2022-2023-春学期-矩阵与数值分析-数值实验大作业" class="headerlink" title="2022-2023 春学期 矩阵与数值分析 数值实验大作业"></a>2022-2023 春学期 矩阵与数值分析 数值实验大作业</h1><h2 id="数值实验大作业题目"><a href="#数值实验大作业题目" class="headerlink" title="数值实验大作业题目"></a>数值实验大作业题目</h2><p>《计算机科学计算》第二版 张宏伟等 编著 高等教育出版社</p>
<p>第162页 第四章课后习题第12（1）题、第16题</p>
<p>第216页 第六章课后习题第12题</p>
<p>《数值分析方法与应用》，张宏伟、孟兆良编著；大连理工大学出版社</p>
<p>第214页：</p>
<p>一、基础知识部分</p>
<p>1、5</p>
<p>二、线性方程组求解</p>
<p>2、6</p>
<p>三、非线性方程组求解</p>
<p>1、4</p>
<p>四、插值与逼近</p>
<p>1、5、7</p>
<p>五、数值积分</p>
<p>2</p>
<p>六、微分方程数值解法</p>
<p>1</p>
<h2 id="实验程序环境"><a href="#实验程序环境" class="headerlink" title="实验程序环境"></a>实验程序环境</h2><pre><code class="lang-python"># colab
# python 3.10
import math
from math import exp
from math import pow
from math import sqrt
from math import sin
from math import cos
from math import pi
import matplotlib.pyplot as plt
import numpy as np
import sympy
</code></pre>
<h2 id="1-1-第四章课后题-12-1"><a href="#1-1-第四章课后题-12-1" class="headerlink" title="1.1 第四章课后题 12(1)"></a>1.1 第四章课后题 12(1)</h2><h3 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h3><p>用 Newton 法求下列方程的根，要求 $|x_k-x_{k-1}|&lt;10^{-5}$</p>
<p>(2) $x=e^{-x}$，取 $x_0=0.6$</p>
<p>程序</p>
<pre><code class="lang-python">def f(x):
  return exp(-x)-x
def df(x):
  return -exp(-x)-1
def Newton(f,df):
  x0 = 0.6
  x1 = 0
  t = abs(x1 - x0)
  while t &gt;= 1e-5:
    x1 = x0-f(x0)/df(x0)
    t = abs(x1-x0)
    print(*[x1,x0,t])
    x0 = x1

  return x0
Newton(f,df)
</code></pre>
<p>输出</p>
<pre><code>0.5669499100387272 0.6 0.03305008996127279
0.5671432836426546 0.5669499100387272 0.00019337360392746028
0.5671432904097838 0.5671432836426546 6.767129190343724e-09
0.5671432904097838
</code></pre><h2 id="1-2-第四章课后题-16"><a href="#1-2-第四章课后题-16" class="headerlink" title="1.2  第四章课后题 16"></a>1.2  第四章课后题 16</h2><h3 id="题目：-1"><a href="#题目：-1" class="headerlink" title="题目："></a>题目：</h3><p>Heonardo 于 1225 年研究了方程</p>
<script type="math/tex; mode=display">
f(x)=x^3+2x^2+10x-20=0</script><p>并得出一个根 $\alpha=1.36880817$，但当时无人知道他用了什么方法，这个结果在当时是个非常著名的结果，请你构造一种简单迭代来验证此结果.</p>
<p>程序</p>
<pre><code class="lang-python">def f(x):
  return pow(x,3)+2*pow(x,2)+10*x-20
def df(x):
  return 3*pow(x,2)+4*x+10
def Newton(f,df):
  x0 = 1
  x1 = 0
  t = abs(x1 - x0)
  while t &gt;= 1e-10:
    x1 = x0-f(x0)/df(x0)
    t = abs(x1-x0)
    print(*[x1,x0,t])
    x0 = x1

  return x0
Newton(f,df)
</code></pre>
<p>输出</p>
<pre><code>1.4117647058823528 1 0.4117647058823528
1.3693364705882352 1.4117647058823528 0.042428235294117655
1.3688081886175318 1.3693364705882352 0.0005282819707033148
1.3688081078213745 1.3688081886175318 8.0796157320151e-08
1.3688081078213727 1.3688081078213745 1.7763568394002505e-15
1.3688081078213727
</code></pre><h2 id="1-3-第六章课后题-12"><a href="#1-3-第六章课后题-12" class="headerlink" title="1.3 第六章课后题 12"></a>1.3 第六章课后题 12</h2><h3 id="题目：-2"><a href="#题目：-2" class="headerlink" title="题目："></a>题目：</h3><p>（数值实验题）人造卫星的轨道可视为平面上的椭圆，地心位于椭圆的一个焦点处。已知一颗人造卫星近地点距地球表面 439km，远地点距地球表面 2384km，地球半径为 6371km，求该卫星的轨道长度</p>
<p>程序</p>
<pre><code class="lang-python">er = 6371
lr = 2384
sr = 439

a = (2*er+lr+sr)/2.
c = a - sr - er/2.
b = sqrt(pow(a,2)-pow(c,2))
e = c/a

# xmpy = sympy.Symbol(&#39;x&#39;)
# print(&quot;true value\t{:s}&quot;.format(str(sympy.integrate(4*a*sympy.sqrt((1-sympy.Pow(e,2)*sympy.Pow(xmpy,2))/(1-sympy.Pow(xmpy,2))),(xmpy,0,1.)))))
# (sympy.integrate(4*a*sympy.sqrt((1-sympy.Pow(e,2)*sympy.Pow(xmpy,2))/
#  (1-sympy.Pow(xmpy,2))),(xmpy,0,1.)))

def f(x):
  return 4.*a*sqrt((1-pow(e,2)*pow(x,2))/(1-pow(x,2)))
def GaussChebyshev(f):
  return pi/2.*(f(-sqrt(2)/2.)+f(sqrt(2)/2.))
GaussChebyshev(f)
</code></pre>
<p>输出</p>
<pre><code>128057.20405940955
</code></pre><h2 id="2-1-基础知识部分-1"><a href="#2-1-基础知识部分-1" class="headerlink" title="2.1 基础知识部分 1"></a>2.1 基础知识部分 1</h2><h3 id="题目：-3"><a href="#题目：-3" class="headerlink" title="题目："></a>题目：</h3><p>设 $S_N=\sum\limits^N_{j=2}\frac{1}{j^2-1}$，其精确值为 $\frac{1}{2}(\frac{3}{2}-\frac{1}{N}-\frac{1}{N+1})$.</p>
<p>（1）编制按从大到小的顺序 $S_N=\frac{1}{2^2-1}+\frac{1}{3^2-1}+\cdots+\frac{1}{N^2-1}$，计算 $S_N$ 的通用程序.</p>
<p>（2）编制按从小到大的顺序 $S_N=\frac{1}{N^2-1}+\frac{1}{(N-1)^2-1}+\cdots+\frac{1}{2^2-1}$，计算 $S_N$ 的通用程序.</p>
<p>（3）按两种顺序分别计算，并指出有效位数（编制程序时用单精度）.</p>
<p>（4）通过本上机题，你明白了什么.</p>
<p>程序</p>
<pre><code class="lang-python">def sn1(N):
  ans=0
  for i in range(2,N+1):
    ans += 1./(pow(i,2)-1)
  return ans
sn1(2)
</code></pre>
<p>输出</p>
<pre><code>0.3333333333333333
</code></pre><p>程序</p>
<pre><code class="lang-python">def sn2(N):
  ans=0
  for i in range(N,2-1,-1):
    ans += 1./(pow(i,2)-1)
  return ans
sn1(2)
</code></pre>
<p>输出</p>
<pre><code>0.3333333333333333
</code></pre><p>程序</p>
<pre><code class="lang-python">print(&quot;从小到大计算 SN，N 从 10 到 10^6 的结果分别为：&quot;)
for i in range(1,7):
  print(&quot;N=10^&quot;+str(i)+&quot;, SN=&quot;+str(sn1(int(pow(10.,i)))))
</code></pre>
<p>输出</p>
<pre><code>从小到大计算 SN，N 从 10 到 10^6 的结果分别为：
N=10^1, SN=0.6545454545454544
N=10^2, SN=0.7400495049504949
N=10^3, SN=0.7490004995005
N=10^4, SN=0.7499000049995057
N=10^5, SN=0.7499900000500057
N=10^6, SN=0.7499990000005217
</code></pre><p>程序</p>
<pre><code class="lang-python">print(&quot;从大到小计算 SN，N 从 10 到 10^6 的结果分别为：&quot;)
for i in range(1,7):
  print(&quot;N=10^&quot;+str(i)+&quot;, SN=&quot;+str(sn2(int(pow(10.,i)))))
</code></pre>
<p>输出</p>
<pre><code>从大到小计算 SN，N 从 10 到 10^6 的结果分别为：
N=10^1, SN=0.6545454545454545
N=10^2, SN=0.7400495049504949
N=10^3, SN=0.7490004995004995
N=10^4, SN=0.7499000049995
N=10^5, SN=0.7499900000499995
N=10^6, SN=0.7499990000004999
</code></pre><p>程序</p>
<pre><code class="lang-python">def sn(N):
  return 1./2.*(3./2.-1./N-1./(N+1))
print(&quot;计算 SN 精确值，N 从 10 到 10^6 的结果分别为：&quot;)
for i in range(1,7):
  print(&quot;N=10^&quot;+str(i)+&quot;, SN=&quot;+str(sn(int(pow(10.,i)))))
</code></pre>
<p>输出</p>
<pre><code>计算 SN 精确值，N 从 10 到 10^6 的结果分别为：
N=10^1, SN=0.6545454545454545
N=10^2, SN=0.740049504950495
N=10^3, SN=0.7490004995004995
N=10^4, SN=0.7499000049995
N=10^5, SN=0.7499900000499995
N=10^6, SN=0.7499990000005
</code></pre><h2 id="2-2-基础知识部分-5"><a href="#2-2-基础知识部分-5" class="headerlink" title="2.2 基础知识部分 5"></a>2.2 基础知识部分 5</h2><h3 id="题目：-4"><a href="#题目：-4" class="headerlink" title="题目："></a>题目：</h3><p>首先编制一个利用秦九韶算法计算一个多项式在给定点的函数值的通用程序，程序包括输入多项式的系数以及给定点，输出函数值，利用编制的程序计算</p>
<p>程序</p>
<pre><code class="lang-python">def qinjiushao(factors, xs):
  # factors 为系数列表，从高次王低次排列
  # xs 为给定点列表
  ans = np.array([])
  for x in xs:
    t = factors[0]
    for f in factors[1:]:
      t = t * x + f
    # ans.append(t)
    ans=np.append(ans,[t])
  return ans
xs = np.arange(1.95,2.05,0.001)
factors = np.array([1,-18,144,-672,2016,-4032,5376,-4608,2304,-512])
y = qinjiushao(factors,xs)
plt.plot(xs, y, label=&quot;p(x)&quot;)
plt.xlabel(&quot;x&quot;)
plt.ylabel(&quot;y&quot;)
plt.xlim(1.95, 2.05)
plt.legend()
plt.show()
print(y)
</code></pre>
<p>输出</p>
<p><img src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/06/10/a2b2daae1e058911341589fb0f1fece9-20230610211208954-0f7a90.png" alt="png"></p>
<pre><code>[-9.66338121e-13  2.95585778e-12  2.04636308e-12 -1.25055521e-12
1.70530257e-12 -1.98951966e-12  6.02540240e-12 -4.60431693e-12
-2.50111043e-12  6.59383659e-12 -3.97903932e-13  6.82121026e-12
-2.27373675e-12 -9.09494702e-13 -1.42108547e-12  5.45696821e-12
-8.01492206e-12  5.34328137e-12 -2.61479727e-12 -3.18323146e-12
-1.76214598e-12  1.13686838e-12  2.27373675e-13 -9.66338121e-13
-2.89901436e-12  1.13686838e-12 -3.01270120e-12 -5.22959454e-12
-2.84217094e-12  1.13686838e-12 -6.13908924e-12 -7.95807864e-13
-6.25277607e-13 -2.27373675e-12  3.86535248e-12 -5.28643795e-12
2.72848411e-12  4.77484718e-12 -2.04636308e-12 -3.41060513e-12
-2.55795385e-12  1.70530257e-12  3.75166564e-12  1.81898940e-12
4.54747351e-13  1.36424205e-12  3.52429197e-12  4.09272616e-12
4.77484718e-12 -7.27595761e-12 -9.66338121e-13  3.86535248e-12
7.95807864e-13  5.00222086e-12  7.04858394e-12  2.04636308e-12
-3.41060513e-13 -1.22781785e-11  6.13908924e-12  2.95585778e-12
3.75166564e-12  4.66116035e-12 -1.76214598e-12  3.86535248e-12
8.75388650e-12  1.13686838e-12 -8.52651283e-13 -4.20641300e-12
4.77484718e-12 -1.13686838e-13  1.25055521e-12  1.05728759e-11
4.88853402e-12  5.00222086e-12  9.32232069e-12 -2.67164069e-12
-1.25055521e-12  5.79802872e-12 -1.10276233e-11 -3.46744855e-12
-5.11590770e-13 -3.97903932e-13  2.38742359e-12 -1.36424205e-12
-6.93489710e-12  6.02540240e-12  2.04636308e-12 -6.13908924e-12
-8.29913915e-12  7.38964445e-12  5.00222086e-12 -3.12638804e-12
-1.59161573e-12  1.93267624e-12  3.29691829e-12 -7.95807864e-13
-5.85487214e-12 -3.92219590e-12  1.13686838e-13  1.70530257e-12]
</code></pre><h2 id="2-3-线性方程组求解-2"><a href="#2-3-线性方程组求解-2" class="headerlink" title="2.3 线性方程组求解 2"></a>2.3 线性方程组求解 2</h2><h3 id="题目：-5"><a href="#题目：-5" class="headerlink" title="题目："></a>题目：</h3><p>编制程序求解矩阵 A 的 Choleskey 分解，并用程序求解方程组 Ax=b，其中</p>
<script type="math/tex; mode=display">
A=
\begin{pmatrix}
7&1&-5&1\\1&9&2&7\\-5&2&7&-1\\1&7&-1&9
\end{pmatrix},\;
b=(13,-9,6,0)^T</script><p>注：书上原矩阵为 $A=\begin{pmatrix}2&amp;1&amp;-5&amp;1\\1&amp;-5&amp;2&amp;7\\0&amp;2&amp;1&amp;-1\\1&amp;7&amp;-1&amp;-4\end{pmatrix}$，不符合课程中有关对称正定矩阵的 Choleskey 分解的要求，因此依据某版本勘误，修改为本题中矩阵。</p>
<p>程序</p>
<pre><code class="lang-python">A = np.array([[7,1,-5,1],[1,9,2,7],[-5,2,7,-1],[1,7,-1,9]])
b = np.array([[13,-9,6,0]]).T
def Choleskey(A):
  ans = np.zeros(A.shape)
  for j in range(A.shape[0]):
    for i in range(j, A.shape[0]):
      t = 0
      for k in range(0,j):
        t += pow(ans[j][k],2)
      ans[j][j] = sqrt(A[j][j]-t)
      t = 0
      for k in range(0,j):
        t += ans[i][k]*ans[j][k]      
      ans[i][j] = (A[i][j]-t)/ans[j][j]
  return ans

# L = Choleskey(A_)
L = Choleskey(A)
print(&quot;L=&quot;)
print(L)

def Lyb(L,b):
  y = np.zeros(b.shape)
  for i in range(b.shape[0]):
    t=0
    for k in range(i):
      t += L[i][k] * y[k][0]
    y[i][0] = (b[i][0]-t)/L[i][i]
  return y
y = Lyb(L,b)
print(&#39;y=&#39;)
print(y)

def LTxy(L,y):
  x = np.zeros(y.shape)
  for i in range(L.shape[0]-1,0-1,-1):
    t = 0
    for k in range(i,L.shape[0]):
      t += L[k][i] * x[k][0]
    x[i][0] = (y[i][0]-t)/L[i][i]
  return x
x = LTxy(L,y)
print(&#39;x=&#39;)
print(x)
</code></pre>
<p>输出</p>
<pre><code>L=
[[ 2.64575131  0.          0.          0.        ]
[ 0.37796447  2.97609524  0.          0.        ]
[-1.88982237  0.91202919  1.61145096  0.        ]
[ 0.37796447  2.30407373 -1.4813338   1.16363107]]
y=
[[ 4.91353815]
[-3.64811674]
[11.55040004]
[20.33151718]]
x=
[[ 19.07798165]
[-21.87155963]
[ 23.2293578 ]
[ 17.47247706]]
</code></pre><h2 id="2-4-线性方程组求解-6"><a href="#2-4-线性方程组求解-6" class="headerlink" title="2.4 线性方程组求解 6"></a>2.4 线性方程组求解 6</h2><h3 id="题目：-6"><a href="#题目：-6" class="headerlink" title="题目："></a>题目：</h3><p>令 $H$ 表示 $n\times n$ 的 Hilbert 矩阵，其中 $(i,j)$ 元素是 $1/(i+j-1)$，b 是元素全为 1 的向量，用 Gauss 消去法求解 Hx=b，其中取</p>
<p>(1) n=2;</p>
<p>(2) n=5;</p>
<p>(3) n=10;</p>
<p>程序</p>
<pre><code class="lang-python">def Hilbert(n):
  ans = np.zeros((n,n))
  for i in range(n):
    for j in range(n):
      ans[i][j] = 1./(i+1+j+1-1)
  return ans

def Gauss(A,b):
  ans = np.zeros(b.shape)
  n = A.shape[0]
  Ab = np.hstack((A,b))

  for j in range(0,n-1):
    for i in range(j+1,n):
      Ab[i] = Ab[i] - Ab[j] * Ab[i][j]/Ab[j][j]
  # print(Ab)
  for i in range(n-1,-1,-1):
    t = 0
    for j in range(i+1,n):
      t += ans[j][0] * Ab[i][j]

    ans[i][0] =  (Ab[i][n] - t)/Ab[i][i]
    # print((i,b[i][0]))
  return ans

for i in [2,5,10]:
  x = Gauss(Hilbert(i), np.ones((i,1)))
  print(&quot;Hx=b, H=Hilbert({:d}),b 是元素全为 1 的向量&quot;.format(i))
  print(x)
</code></pre>
<p>输出</p>
<pre><code>Hx=b, H=Hilbert(2),b 是元素全为 1 的向量
[[-2.]
[ 6.]]
Hx=b, H=Hilbert(5),b 是元素全为 1 的向量
[[    5.]
[ -120.]
[  630.]
[-1120.]
[  630.]]
Hx=b, H=Hilbert(10),b 是元素全为 1 的向量
[[-9.99726592e+00]
[ 9.89763037e+02]
[-2.37549411e+04]
[ 2.40193928e+05]
[-1.26103993e+06]
[ 3.78317436e+06]
[-6.72572540e+06]
[ 7.00031810e+06]
[-3.93771469e+06]
[ 9.23668814e+05]]
</code></pre><h2 id="2-5-非线性方程组求解-1"><a href="#2-5-非线性方程组求解-1" class="headerlink" title="2.5 非线性方程组求解 1"></a>2.5 非线性方程组求解 1</h2><h3 id="题目：-7"><a href="#题目：-7" class="headerlink" title="题目："></a>题目：</h3><p>分别应用 Newton 迭代法和割线法计算</p>
<p>（1）非线性方程 $2x^3+5x+1=0$ 在 $[1,2]$ 上的一个根</p>
<p>（2）$e^x\sin x=0$ 在 $[-4,-3]$ 上的一个根</p>
<p>程序</p>
<pre><code class="lang-python">def f1(x):
  return 2*pow(x,3)+5*x+1
def df1(x):
  return 6*x + 5
def f2(x):
  return exp(x)*sin(x)
def df2(x):
  return exp(x)*sin(x)+exp(x)*cos(x)
def Newton(f,df,y,lb,rb):
  x = (lb+rb)/2.
  while abs(f(x)-y)&gt;1e-10:
    x = x-f(x)/df(x)
  return x
def cutlines(f,y,lb,rb):
  x0=np.random.uniform(lb,rb)
  x1=np.random.uniform(x0,rb)
  x = x1
  while abs(f(x)-y)&gt;1e-10:
    x = x1 - (x1-x0)*f(x1)/(f(x1)-f(x0))
    x0 = x1
    x1 = x
  return x
#(1)
print(&#39;(1)&#39;)
print(&#39;Newton 法： &#39;+str(Newton(f1,df1,0.,1.,2.)))
print(&#39;割线法： &#39;+str(cutlines(f1,0.,1.,2.)))
#(2)
print(&#39;(2)&#39;)
print(&#39;Newton 法： &#39;+str(Newton(f2,df2,0.,-4.,-3.)))
print(&#39;割线法： &#39;+str(cutlines(f2,0.,-4.,-3.)))

np.random.uniform(1,2)
xt = np.arange(-1,2,0.001)
yt = np.array([f1(i) for i in xt])
def pltshow(X,Y):
  fig = plt.figure(figsize=(8,6), dpi=72,facecolor=&quot;white&quot;)
  axes = plt.subplot(111)
  axes.plot(X,Y)#, color = &#39;blue&#39;, linewidth=2, linestyle=&quot;-&quot;)
  axes.set_xlim(1.01*X.min(),1.01*X.max())
  axes.set_ylim(1.01*Y.min(),1.01*Y.max())

  axes.spines[&#39;right&#39;].set_color(&#39;none&#39;)
  axes.spines[&#39;top&#39;].set_color(&#39;none&#39;)
  axes.xaxis.set_ticks_position(&#39;bottom&#39;)
  axes.spines[&#39;bottom&#39;].set_position((&#39;data&#39;,0))
  axes.yaxis.set_ticks_position(&#39;left&#39;)
  axes.spines[&#39;left&#39;].set_position((&#39;data&#39;,0))
  plt.show()
pltshow(xt,yt)
</code></pre>
<p>输出</p>
<pre><code>(1)
Newton 法： -0.1969444376699362
割线法： -0.19694443765320088
(2)
Newton 法： -3.141592653579501
割线法： -3.1415926535895866
</code></pre><p><img src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/06/10/a4b0d007b3d173ef957d5e9937bacdb7-20230610211229195-d8222a.png" alt="png"></p>
<h2 id="2-6-非线性方程组-4"><a href="#2-6-非线性方程组-4" class="headerlink" title="2.6 非线性方程组 4"></a>2.6 非线性方程组 4</h2><h3 id="题目：-8"><a href="#题目：-8" class="headerlink" title="题目："></a>题目：</h3><p> 用 Newton 迭代法求解方程 $x^3+x^2+x-3=0$ 的根，初值选择 $x_0=-0.7$，迭代 7 步并与真值 相比较，并列出数据表</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$i$</th>
<th style="text-align:center">$x_i$</th>
<th style="text-align:center">$e_i=</th>
<th style="text-align:center">x_i-x^*</th>
<th>$</th>
<th>$\frac{e_i}{e_2^{i-1}}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>
<p>程序</p>
<pre><code class="lang-python">def Newton7(f,df,y,xtrue=1):
  x = -0.7
  c = 0
  e = abs(x - xtrue)

  print(*[c,x,e,e/pow(e,2)])
  while abs(f(x)-y)&gt;1e-10 and c &lt; 11:

    x = x-f(x)/df(x)
    c += 1
    e = abs(x-xtrue)
    print(*[c,x,e,e/pow(e,2)])

  return x
def f(x):
  return pow(x,3)+pow(x,2)+x-3
def df(x):
  return 3*pow(x,2)+2*x+1
Newton7(f,df,0)
</code></pre>
<p>输出</p>
<pre><code>0 -0.7 1.7 0.5882352941176471
1 2.6205607476635517 1.6205607476635517 0.6170703575547865
2 1.7084401902625614 0.7084401902625614 1.4115517636420105
3 1.2063786980181086 0.2063786980181086 4.845461327177554
4 1.024161664125103 0.02416166412510301 41.387877706694866
5 1.0003814911210203 0.00038149112102026095 2621.2929866509007
6 1.0000000969928142 9.699281422470563e-08 10310042.120061344
7 1.0000000000000062 6.217248937900877e-15 160842843834660.56
1.0000000000000062
</code></pre><h2 id="2-7-插值与逼近-1"><a href="#2-7-插值与逼近-1" class="headerlink" title="2.7 插值与逼近 1"></a>2.7 插值与逼近 1</h2><h3 id="题目：-9"><a href="#题目：-9" class="headerlink" title="题目："></a>题目：</h3><p>已知函数 $f(x)=\frac{1}{1+x^2}$，在 $[-5,5]$ 上分别取 $2,1,\frac{1}{2}$ 为单位长度的等距节点作为插值节点，用 Lagrange 方法插值，并把原函数图与插值函数图比较，观察插值效果</p>
<p>程序</p>
<pre><code class="lang-python">def f(x):
  return 1./(1+np.power(x,2))

x = np.array(
    [np.arange(-5,5.1,2.),
    np.arange(-5,5.1,1.),
    np.arange(-5,5.1,0.5)]
)

y = f(x)

def LagrangeInterpolation(x,y):
  def ans(x_):
    res = 0
    n = y.shape[0];
    L = np.ones(n)
    for i in range(n):
      for j in range(n):
        if j != i:
          L[i] *= (x_ - x[j])
          L[i] /= (x[i] - x[j])
      L[i] *= y[i]
    return L.sum()
  return ans

for i in range(3):
  L = LagrangeInterpolation(x[i],y[i])
labels=[
    &#39;step=2&#39;,&#39;step=1&#39;,&#39;step=0.5&#39;
]
for i,j,k in zip(x,y,labels):
  plt.plot(i,j,label=k)
xtrue = np.arange(-5,5.0001,0.01)
ytrue = f(xtrue)
plt.plot(xtrue,ytrue,label=&#39;ytrue&#39;)
plt.legend()
plt.grid()
plt.show()
</code></pre>
<p>输出</p>
<pre><code>    &lt;ipython-input-18-04d7d62ca026&gt;:4: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
      x = np.array(
</code></pre><p><img src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/06/10/9a3a1a8fa5a2adae1c0bfd2dd7767c94-20230610211250239-e64006.png" alt="png"></p>
<h2 id="2-8-插值与逼近-5"><a href="#2-8-插值与逼近-5" class="headerlink" title="2.8 插值与逼近 5"></a>2.8 插值与逼近 5</h2><h3 id="题目：-10"><a href="#题目：-10" class="headerlink" title="题目："></a>题目：</h3><p>考虑函数 $f(x)=\sin\pi x,x\in[0,1]$，用等距节点作$f(x)$的Newton插值，画出插值多项式以及$f(x)$的图像，观察收敛性</p>
<p>程序</p>
<pre><code class="lang-python">def f(x):
  return np.sin(pi*x)
def NewtonInterpolation(x,y,h):

  res = 0.
  n = x.shape[0]
  # DD = np.zeros((n+1,n))
  # DD[0] = x
  # DD[1] = y
  DD = np.zeros((n,n))
  DD[0] = y
  DD = DD.T
  # print(DD)
  # for i in range(2,n+1):
  #   for j in range(i-1,n):
  #     DD[j][i] = (DD[j][i-1]-DD[j-1][i-1])/((i-1)*h)
  # print(DD)
  for i in range(1,n):
    for j in range(i,n):
      DD[j][i] = (DD[j][i-1]-DD[j-1][i-1])/((i)*h)
  # print(DD)
  def ans(x_):
    res=0
    res += DD[0][0]
    for i in range(1,n):
      t = 1
      for j in range(i):
        t *= (x_-x[j])
      res += DD[i][i] * t
    return res
  return ans
h=0.001
x = np.arange(0,1.01,h)
y = f(x)
plt.plot(x,y,label=&#39;fx&#39;)

h=0.02
x = np.arange(0,1.01,h)
y = f(x)
p = NewtonInterpolation(x,y,h)
py = p(x)

plt.plot(x,py,label=&#39;px&#39;)
plt.legend()
plt.grid()
plt.show()
</code></pre>
<p>输出</p>
<p><img src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/06/10/8eb3b707270b2749d4bf3a813cecd0cb-20230610211257923-c3d109.png" alt="png"></p>
<h2 id="2-9-插值与逼近-7"><a href="#2-9-插值与逼近-7" class="headerlink" title="2.9 插值与逼近 7"></a>2.9 插值与逼近 7</h2><h3 id="题目：-11"><a href="#题目：-11" class="headerlink" title="题目："></a>题目：</h3><p>编程计算三次样条 S，满足 $S(0)=1,S(1)=3,S(2)=3,S(3)=4,S(4)=2$,其中边界条件$S’’(0)=S’’(4)=0$</p>
<p>程序</p>
<pre><code class="lang-python">def NaturalCubicSpline(x,y):
  # p149-p150; algorithm 3.4; Numerical Analysis 9th Autor: Richard L.Burden and J.Douglas Faires
  n = x.shape[0] - 1
  h = np.zeros((n,))
  abcd = np.zeros((n,n+1))
  abcd = abcd.T
  a,b,c,d = y,np.zeros((n+1,)),np.zeros((n+1,)),np.zeros((n+1,))
  # step 1
  for i in range(0,n):
    h[i] = x[i+1]-x[i]
  # step 2
  alpha = np.zeros((n,))
  for i in range(1,n):
    alpha[i]=3./h[i]*(a[i+1]-a[i])-3./h[i-1]*(a[i]-a[i-1])
  # step 3
  L,u,z = np.zeros((n+1,)),np.zeros((n+1,)),np.zeros((n+1,))
  L[0] = 1
  u[0] = 0
  z[0] = 0
  # step 4
  for i in range(1,n):
    L[i]=2*(x[i+1]-x[i-1])-h[i-1]*u[i-1]
    u[i]=h[i]/L[i]
    z[i]=(alpha[i]-h[i-1]*z[i-1])/L[i]
  # step 5
  L[n]=1
  z[n]=0
  c[n]=0
  # step 6
  for j in range(n-1,-1,-1):
    c[j]=z[j]-u[j]*c[j+1]
    b[j]=(a[j+1]-a[j])/h[j]-h[j]*(c[j+1]+2*c[j])/3.
    d[j]=(c[j+1]-c[j])/(3.*h[j])
  # print(a)
  # print(b)
  # print(c)
  # print(d)
  abcd[0]=a[:-1]
  abcd[1]=b[:-1]
  abcd[2]=c[:-1]
  abcd[3]=d[:-1]
  abcd = abcd.T
  print(abcd)
  def spline(x_):
    res = 0
    t = x[0]
    for i in range(n):
      # print((x_,x[i],x[i+1]))
      if x_ &gt;= x[i] and x_ &lt;= x[i+1]:
        t = i
        break
    for i in range(n+1):
      res += abcd[t][i] * pow(x_-x[t],i)
    return res
  return spline
x = np.array([0.,1.,2.,3.,4.])
y = np.array([1.,3.,3.,4.,2.])
spl = NaturalCubicSpline(x,y)
x_ = np.arange(0,4.01,0.01)
y_ = [spl(i) for i in x_]
plt.plot(x_,y_,label=&#39;spline&#39;)
plt.grid()
plt.legend()
plt.show()
</code></pre>
<p>输出</p>
<pre><code>[[ 1.          2.66071429  0.         -0.66071429  0.        ]
[ 3.          0.67857143 -1.98214286  1.30357143  0.        ]
[ 3.          0.625       1.92857143 -1.55357143  0.        ]
[ 4.         -0.17857143 -2.73214286  0.91071429  0.        ]]
</code></pre><p><img src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/06/10/9726bd0146b1f8dcedb529a27b45da43-20230610211241365-8935aa.png" alt="png"></p>
<h2 id="2-10-数值积分-2"><a href="#2-10-数值积分-2" class="headerlink" title="2.10 数值积分 2"></a>2.10 数值积分 2</h2><h3 id="题目：-12"><a href="#题目：-12" class="headerlink" title="题目："></a>题目：</h3><p>用两点，三点和五点的Gauss型积分公式分别计算定积分，并与真值作比较</p>
<script type="math/tex; mode=display">
S=\int^\frac{\pi}{2}_0x^2\cos x\mathrm{d}x</script><p>本题使用 Gauss-Legendre 公式，通过查表可知对应的系数以及 Gauss 点如下表所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$n$</th>
<th style="text-align:center">Roots $r_{n,i}$</th>
<th style="text-align:center">Coefficients $c_{n,j}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0.5773502692</td>
<td style="text-align:center">1.0000000000</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">−0.5773502692</td>
<td style="text-align:center">1.0000000000</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">0.7745966692</td>
<td style="text-align:center">0.5555555556</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.0000000000</td>
<td style="text-align:center">0.8888888889</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">−0.7745966692</td>
<td style="text-align:center">0.5555555556</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">0.8611363116</td>
<td style="text-align:center">0.3478548451</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.3399810436</td>
<td style="text-align:center">0.6521451549</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">−0.3399810436</td>
<td style="text-align:center">0.6521451549</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">−0.8611363116</td>
<td style="text-align:center">0.3478548451</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">0.9061798459</td>
<td style="text-align:center">0.2369268850</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.5384693101</td>
<td style="text-align:center">0.4786286705</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.0000000000</td>
<td style="text-align:center">0.5688888889</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">−0.5384693101</td>
<td style="text-align:center">0.4786286705</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">−0.9061798459</td>
<td style="text-align:center">0.2369268850</td>
</tr>
</tbody>
</table>
</div>
<p>程序</p>
<pre><code class="lang-python">xmpy = sympy.Symbol(&#39;x&#39;)
print(&quot;true value\t{:s}&quot;.format(str(sympy.integrate(sympy.cos(xmpy)*xmpy*xmpy,(xmpy,0,pi/2.)))))

def f(x):
  return pow(x,2)*cos(x)
def GaussLegendreIntergrate(f,x,coefficients):
  res = 0
  for i,j in zip(x,coefficients):
    res += f(i)*j
  return res
# n=2
x=[0.5773502692,-0.5773502692] 
coefficients=[1.0000000000,1.0000000000]
print(&quot;n=2,\t\t{:s}&quot;.format(str(GaussLegendreIntergrate(f,x,coefficients))))
# n=3
x=[0.7745966692,0.0000000000,-0.7745966692]
coefficients=[0.5555555556,0.8888888889,0.5555555556]
print(&quot;n=3,\t\t{:s}&quot;.format(str(GaussLegendreIntergrate(f,x,coefficients))))
# n=5
x=[0.9061798459, 0.5384693101, 0.0000000000, -0.5384693101, -0.9061798459]
coefficients=[ 0.236926885, 0.4786286705, 0.5688888889, 0.4786286705, 0.2369268850]
print(&quot;n=5,\t\t{:s}&quot;.format(str(GaussLegendreIntergrate(f,x,coefficients))))
</code></pre>
<p>输出</p>
<pre><code>true value    0.467401100272340
n=2,        0.5586078851462954
n=3,        0.476468795309243
n=5,        0.4782671832477956
</code></pre><h2 id="2-11-微分方程数值解法-1"><a href="#2-11-微分方程数值解法-1" class="headerlink" title="2.11 微分方程数值解法 1"></a>2.11 微分方程数值解法 1</h2><h3 id="题目：-13"><a href="#题目：-13" class="headerlink" title="题目："></a>题目：</h3><p> 已知常微分方程</p>
<script type="math/tex; mode=display">
\left\{
\begin{array}{l}
\frac{\mathrm{d}u}{\mathrm{d}x}=\frac{2}{x}u+x^2e^x\\                x\in[1,2],u(1)=0
\end{array}
\right.</script><p>分别用Euler法，改进的Euler法，Runge-Kutta法求解该方程，步长选为0.1，0.05，0.01，画图观察求解效果</p>
<p>程序</p>
<pre><code class="lang-python">hs=[0.1,0.05,0.01]
def f(u,x):
  return 2.*u/x+pow(x,2)*exp(x)
def Euler(u,h,x,f):
  return u+h*f(u,x)
def EulerImprove(u,h,x,f,*args):
  u_=u+h*f(u,x)
  return u+h/2.*(f(u,x)+f(u,x+h))
def RungeKutta(u,h,x,f):
  # 4 阶
  # p288-p289; algorithm 5.2; Numerical Analysis 9th Autor: Richard L.Burden and J.Douglas Faires
  # 此处课件与上述参考书目不同，课件中 k2,k3,k4 的 u 的迭代过程多乘了一个 h
  # 可与下一单元格中对应位置作对比
  k1 = h*f(u,x)
  k2 = h*f(u+h*k1/2.,x+h/2.)
  k3 = h*f(u+h*k2/2.,x+h/2.)
  k4 = h*f(u+h*k3,x+h)
  return u + (k1+2*k2+2*k3+k4)/6.


functions=[Euler,EulerImprove,RungeKutta]
labels = [&#39;Euler&#39;,&#39;Euler-improve&#39;,&#39;Runge-kutta&#39;]
fig = plt.figure(figsize=(12,3))
fig.subplots_adjust(hspace=0.4, wspace=0.4)
for h in hs:
  # axes = plt.subplot()
  # axes.set_xlim(0.99,2.01)
  # axes
  subplot = plt.subplot(1,3,hs.index(h)+1)
  subplot.set_xlim(0.99,2.01)
  subplot.set_ylim(-0.01,19.)
  for fun,label in zip(functions,labels):
    x = 1
    u1 = 0
    us = []
    xs = []
    while x &lt; 2:
      us.append(u1)
      xs.append(x)
      u2 = fun(u1,h,x,f)
      x += h
      u1 = u2
    # plt.subplot(1,3,hs.index(h)+1)
    plt.plot(xs,us,label = label)

  plt.title(&quot;h={:f}&quot;.format(h))
  plt.xlabel(&quot;x&quot;)
  plt.ylabel(&quot;u&quot;)
  plt.legend()
  plt.grid()
plt.show()
</code></pre>
<p>输出</p>
<p><img src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/06/10/e70fab8d4075c42e84c5e85419444a64-20230610211151570-336906.png" alt="png"></p>
<p>程序</p>
<pre><code class="lang-python">x=np.arange(0,2,0.2)
x = 0.
u1 = 0.5
h = 0.2
def RungeKutta(u,h,x,f):
  # 4 阶
  # p288-p289; algorithm 5.2; Numerical Analysis 9th Autor: Richard L.Burden and J.Douglas Faires
  # 此处课件与上述参考书目不同，参考书目中 k2,k3,k4 的 u 的迭代过程少乘了一个 h
  # 可与上一单元格中对应位置作对比
  k1 = h*f(u,x)
  k2 = h*f(u+k1/2.,x+h/2.)
  k3 = h*f(u+k2/2.,x+h/2.)
  k4 = h*f(u+k3,x+h)
  print((k1,k2,k3,k4))
  return u + (k1+2*k2+2*k3+k4)/6.
def f(u,x):
  return u-pow(x,2)+1
while x &lt; 2:
  print(u1)
  u2 = RungeKutta(u1,h,x,f)
  x += h
  u1 = u2
</code></pre>
<p>输出</p>
<pre><code>0.5
(0.30000000000000004, 0.32800000000000007, 0.3308, 0.35816000000000003)
0.8292933333333334
(0.3578586666666667, 0.38364453333333337, 0.38622312000000003, 0.41110329066666673)
1.2140762106666667
(0.4108152421333333, 0.4338967663466667, 0.43620491876800005, 0.4580562258869334)
1.6489220170416001
(0.45778440340832005, 0.477562843749152, 0.4795406877832353, 0.49769254096496707)
2.1272026849479437
(0.49744053698958873, 0.5131845906885476, 0.5147589960584436, 0.5283923362012776)
2.6408226927287517
(0.5281645385457504, 0.5389809924003254, 0.5400626377857828, 0.548177066102907)
3.1798941702322305
(0.5479788340464461, 0.5527767174510906, 0.5532565057915552, 0.5546301352047571)
3.7323400728549796
(0.5544680145709959, 0.5519148160280957, 0.5516594961738054, 0.544799913805757)
4.283409498318406
(0.5446818996636813, 0.5331500896300494, 0.5319969086266862, 0.5150812813890185)
4.815085694579435
(0.5150171389158871, 0.4925188528074757, 0.4902690241966345, 0.46107094375521407)
5.305363000692655
(0.46107260013853113, 0.42517986015238435, 0.42159058615376976, 0.3773907173692852)
</code></pre>
        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <!--<li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@mainnull"></li>-->
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/custom/donate/WechanSQ2.jpg"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2023/06/10/2022-2023-春学期-矩阵与数值分析-考试的范围/" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/03/10/6f1078d467166b315085abd04baa58bb-20230310134509511-d8f3a7.png" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/03/10/6f1078d467166b315085abd04baa58bb-20230310134509511-d8f3a7.png">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                2022-2023 春学期 矩阵与数值分析 考试的范围</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2023/06/10/2022-2023-春学期-矩阵与数值分析-C7-常微分方程的数值解法/" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/03/10/6f1078d467166b315085abd04baa58bb-20230310134509511-d8f3a7.png" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://fastly.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/blogPic/2023/03/10/6f1078d467166b315085abd04baa58bb-20230310134509511-d8f3a7.png">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                2022-2023 春学期 矩阵与数值分析 C7 常微分方程的数值解法</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      





    <div id="tcomment"></div>
	<style>
	.el-textarea__inner{
		height: 130px;
	}
	</style>
    <script src="https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js"></script>
    <script>
    window.onload = function () {
      var loadTime = window.performance.timing.domContentLoadedEventEnd - window.performance.timing.navigationStart;
      document.getElementById("page_loading_time").innerHTML = "It took me " + loadTime + "ms to meet you this time";
      console.log('Page load time is ' + loadTime);
      // var valine = new Valine();
      // valine.init({
      //   el: '#vcomments',
      //   avatar: 'monsterid',
      //   appId: "",
      //   appKey: "",
      //   path: window.location.pathname,
      //   serverURL: "",
      //   placeholder: "你是我一生只会遇见一次的惊喜"
      // })
        twikoo.init({
          envId: 'https://vercel-for-blog.vercel.app/', // 腾讯云环境填 envId；Vercel 环境填地址（https://xxx.vercel.app）
          el: '#tcomment', // 容器元素
          // region: 'ap-guangzhou', // 环境地域，默认为 ap-shanghai，腾讯云环境填 ap-shanghai 或 ap-guangzhou；Vercel 环境不填
          // path: location.pathname, // 用于区分不同文章的自定义 js 路径，如果您的文章路径不是 location.pathname，需传此参数
          // lang: 'zh-CN', // 用于手动设定评论区语言，支持的语言列表 https://github.com/imaegoo/twikoo/blob/main/src/client/utils/i18n/index.js
        })
    }
    </script>


      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="https://owuiviuwo.github.io/" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/avatar.jpg" itemprop="image" alt="owuiviuwo" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="https://owuiviuwo.github.io/" itemprop="url" rel="author">owuiviuwo</a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i>Learn and Live</p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 owuiviuwo<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;" id="blog_running_year">&copy 2022-2023 owuiviuwo</p>
	  <p style="color: #999; font-size:10px;" id="page_loading_time"></p>
      <!--<p style="color: #666666;" id="blog_running_year">&copy <span id="blog_running_year_cal"></span> owuiviuwo</p>-->
      <p style="color: #aaa; font-size: 13px;" id="blog_running_time" ></p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> 
		<i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by 
		<a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&
		<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a><!--, Powered by Hexo, Hosted by Coding Pages</a>-->
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"0","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"0","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
//var startDay = new Date("2022-12-15");
//var nowDay = new Date();
//var dayDiff = Math.floor((nowDay-startDay)/24/60/60/1000);
//console.log("网站已运行 " + dayDiff + "天！");
//document.getElementById("blog_running_time").innerHTML = "&copy 2022-"+ nowDay.getFullYear() +" owuiviuwo";

function siteTime() {
	var seconds = 1000;
	var minutes = seconds * 60;
	var hours = minutes * 60;
	var days = hours * 24;
	var years = days * 365;
	var today = new Date();
	var startYear = "2022";
	var startMonth = "12";
	var startDate = "15";
	var startHour = "0";
	var startMinute = "0";
	var startSecond = "0";
	var todayYear = today.getFullYear();
	var todayMonth = today.getMonth() + 1;
	var todayDate = today.getDate();
	var todayHour = today.getHours();
	var todayMinute = today.getMinutes();
	var todaySecond = today.getSeconds();
	var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
	var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
	var diff = t2 - t1;
	var diffYears = Math.floor(diff / years);
	var diffDays = Math.floor((diff / days) - diffYears * 365);
	var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
	var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
		minutes);
	var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
		diffMinutes * minutes) / seconds);
		
	diffDays = diffDays < 10 ? '0' + diffDays : diffDays;
	diffHours = diffHours < 10 ? '0' + diffHours : diffHours;
	diffMinutes = diffMinutes < 10 ? '0' + diffMinutes : diffMinutes;
	diffSeconds = diffSeconds < 10 ? '0' + diffSeconds : diffSeconds;
		
//	if (startYear == todayYear) {
//		document.getElementById("blog_running_year_cal").innerHTML = todayYear;
//	} else {
//		document.getElementById("blog_running_year_cal").innerHTML = startYear + " - " + todayYear;
//	}
	if (diffYears == 0) {
		document.getElementById("blog_running_time").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
			" 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
	} else{
		document.getElementById("blog_running_time").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
			" 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
	}
}
setInterval(siteTime, 1000);
            
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
      <!-- 实现换肤功能 -->
  <div class="skin-menu no-select" id="mainskin" style="position: fixed">
 <div class="theme-controls row-container">
  <ul class="menu-list">
   <li id="white-bg"> <i class="fa fa-television" aria-hidden="true"></i></li>
   <li id="sakura-bg"> <i class="iconfont icon-sakura"></i></li>
   <li id="gribs-bg"> <i class="fa fa-slack" aria-hidden="true"></i></li>
   <li id="KAdots-bg"> <i class="iconfont icon-dots"></i></li>
   <li id="totem-bg"> <i class="fa fa-optin-monster" aria-hidden="true"></i></li>
   <li id="pixiv-bg"> <i class="iconfont icon-pixiv"></i></li>
   <li id="bing-bg"> <i class="iconfont icon-bing"></i></li>
   <li id="dark-bg"> <i class="fa fa-moon-o" aria-hidden="true"></i></li>
  </ul>
 </div>
</div>
<canvas id="night-mode-cover"></canvas> 
  <div class="changeSkin-gear no-select" >
  <div class="keys" id="setbtn"> 
   <span id="open-skinMenu"> 切换主题 | SCHEME TOOL  
     <i class="iconfont icon-gear inline-block rotating"></i> 
   </span>
  </div>
</div>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/owuiviuwo/BlogCDN@main/avatar.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">owuiviuwo</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/owuiviuwo" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
        <a href="https://www.cnblogs.com/owuiviuwo" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
        <a href="https://www.zhihu.com/people/owuiviuwo" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
        <a href="mailto:owuiviuwo@163.com" class="fa " target="_blank" style="color: #; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/生活/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  生活
                </a>
              </li>
            
              <li>
                <a href="/categories/资源/">
                  <i class="fa fa-cloud-download" aria-hidden="true"></i>
                  资源
                </a>
              </li>
            
              <li>
                <a href="/categories/随想/">
                  <i class="fa fa-commenting-o" aria-hidden="true"></i>
                  随想
                </a>
              </li>
            
              <li>
                <a href="/categories/转载/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  转载
                </a>
              </li>
            
              <li>
                <a href="/random.html">
                  <i class="fa fa-random" aria-hidden="true"></i>
                  随机
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            数据
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/statistics/">
                  <i class="fa fa-line-chart" aria-hidden="true"></i>
                  统计
                </a>
              </li>
            
              <li>
                <a href="/postcategory/">
                  <i class="fa fa-list-ul faa-vertical" aria-hidden="true"></i>
                  分类
                </a>
              </li>
            
              <li>
                <a href="/tags/">
                  <i class="fa fa-tags" aria-hidden="true"></i>
                  标签
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/shuoshuo/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-clock-o" aria-hidden="true"></i>
            说说
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/links/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
            友人帐
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/donate/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
            赞赏
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            其他
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
              <li>
                <a href="/theme-sakura/">
                  <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                  主题
                </a>
              </li>
            
              <li>
                <a href="/lab/">
                  <i class="fa fa-cogs" aria-hidden="true"></i>
                  Lab
                </a>
              </li>
            
              <li>
                <a href="/atom.xml">
                  <i class="fa fa-rss faa-pulse" aria-hidden="true"></i>
                  RSS
                </a>
              </li>
            
          </ul>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  
 

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>